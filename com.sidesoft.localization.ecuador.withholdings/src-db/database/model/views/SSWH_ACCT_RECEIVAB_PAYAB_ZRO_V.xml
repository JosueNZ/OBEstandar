<?xml version="1.0"?>
  <database name="VIEW SSWH_ACCT_RECEIVAB_PAYAB_ZRO_V">
    <view name="SSWH_ACCT_RECEIVAB_PAYAB_ZRO_V"><![CDATA[SELECT 'ACSI' AS doc_code, 'Anticipo Cliente' AS doc_type, bp.name AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, p.paymentdate AS documentdate, p.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, p.paymentdate AS duedate, pd.amount * (-1) AS grandtotal, c_currency_convert(pd.amount, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) * (-1) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, NULL AS fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_bpartner bp ON p.c_bpartner_id = bp.c_bpartner_id LEFT JOIN fin_financial_account fa ON p.fin_financial_account_id = fa.fin_financial_account_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id WHERE fa.name LIKE '%Anticipo Cliente SI%' UNION ALL SELECT 'AC' AS doc_code, 'Anticipo Cliente' AS doc_type, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = p.c_bpartner_id) AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, p.paymentdate AS documentdate, p.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, NULL AS duedate, pdv.paidamt * (-1) AS grandtotal, c_currency_convert(pdv.paidamt, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) * (-1) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, p.fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN ssfi_fin_payment_detail_v pdv ON p.fin_payment_id = pdv.fin_payment_id LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id LEFT JOIN fin_payment_credit pc ON p.fin_payment_id = pc.fin_payment_id WHERE p.amount = 0 AND (p.status = 'RDNC' OR p.status = 'RPPC' OR p.status = 'RPR') AND pdv.glitemname IS NULL AND pdv.fin_payment_sched_inv_id IS NULL AND p.isreceipt = 'Y' AND pd.isprepayment = 'Y' AND p.generated_credit = pdv.paidamt UNION ALL SELECT 'AC' AS doc_code, 'Anticipo Cliente' AS doc_type, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = p.c_bpartner_id) AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, c.paymentdate AS documentdate, c.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, NULL AS duedate, b.amount AS grandtotal, c_currency_convert(b.amount, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, NULL AS fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN ssfi_fin_payment_detail_v pdv ON p.fin_payment_id = pdv.fin_payment_id LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id LEFT JOIN fin_payment_credit b ON p.fin_payment_id = b.fin_payment_id_used LEFT JOIN fin_payment c ON b.fin_payment_id = c.fin_payment_id WHERE p.amount = 0 AND (p.status = 'RDNC' OR p.status = 'RPPC' OR p.status = 'RPR') AND pdv.glitemname IS NULL AND pdv.fin_payment_sched_inv_id IS NULL AND p.isreceipt = 'Y' AND pd.isprepayment = 'Y' AND p.generated_credit = pdv.paidamt UNION ALL SELECT 'APSI' AS doc_code, 'Anticipo Proveedor' AS doc_type, c.name AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, p.paymentdate AS documentdate, p.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, p.paymentdate AS duedate, pd.amount * (-1) AS grandtotal, c_currency_convert(pd.amount, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) * (-1) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, NULL AS fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_bpartner c ON p.c_bpartner_id = c.c_bpartner_id LEFT JOIN fin_financial_account d ON p.fin_financial_account_id = d.fin_financial_account_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id WHERE d.name LIKE '%Anticipo Proveedor SI%' UNION ALL SELECT 'AP' AS doc_code, 'Anticipo Proveedor' AS doc_type, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = p.c_bpartner_id) AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, p.paymentdate AS documentdate, p.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, NULL AS duedate, pdv.paidamt * (-1) AS grandtotal, c_currency_convert(pdv.paidamt, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) * (-1) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, NULL AS fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN ssfi_fin_payment_detail_v pdv ON p.fin_payment_id = pdv.fin_payment_id LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id WHERE p.amount = 0 AND (p.status = 'PWNC' OR p.status = 'RPPC' OR p.status = 'PPM') AND pdv.glitemname IS NULL AND p.isreceipt = 'N' AND pd.isprepayment = 'Y' AND p.generated_credit = pdv.paidamt UNION ALL SELECT 'AP' AS doc_code, 'Anticipo Proveedor' AS doc_type, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = p.c_bpartner_id) AS bpartner_name, p.documentno AS invoice, p.documentno AS applied, c.paymentdate AS documentdate, c.paymentdate AS dateacct, p.referenceno AS poreference, to_char(p.description) AS description, NULL AS duedate, b.amount AS grandtotal, c_currency_convert(b.amount, p.c_currency_id, '100', p.paymentdate, NULL, p.ad_client_id, p.ad_org_id) AS grandtotalconverted, dt.name AS doctype, cc.name AS costcenter, cc.c_costcenter_id, p.isreceipt AS isclient, p.posted, p.c_bpartner_id, NULL AS fin_payment_id, p.c_currency_id, p.ad_client_id, p.ad_org_id, to_char('') AS c_invoice_id, to_char('') AS em_sswh_withholdingref, to_number(0) AS em_sswh_totalwithholdingincome, to_number(0) AS em_sswh_totalwithholdingvat FROM fin_payment p LEFT JOIN ssfi_fin_payment_detail_v pdv ON p.fin_payment_id = pdv.fin_payment_id LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN c_doctype dt ON p.c_doctype_id = dt.c_doctype_id LEFT JOIN c_costcenter cc ON p.c_costcenter_id = cc.c_costcenter_id LEFT JOIN fin_payment_credit b ON p.fin_payment_id = b.fin_payment_id_used LEFT JOIN fin_payment c ON b.fin_payment_id = c.fin_payment_id WHERE p.amount = 0 AND (p.status = 'PWNC' OR p.status = 'RPPC' OR p.status = 'PPM') AND pdv.glitemname IS NULL AND p.isreceipt = 'N' AND pd.isprepayment = 'Y' AND p.generated_credit = pdv.paidamt]]></view>
  </database>
